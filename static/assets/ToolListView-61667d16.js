import{e as a,A as H,_ as oe,r as v,o as Y,b as m,c as u,d as g,w as t,k as w,F as Z,g as p,l as K,q as le,u as ie,h as q,f as c,P as se,D as G,t as P,E as re,s as ce}from"./index-c5623d35.js";import{c as x,A as ue,T as de,f as pe}from"./AppLayout-91e68111.js";import{B as fe,P as me}from"./PauseCircleOutlined-01fd97b2.js";import{P as _e}from"./PlayCircleOutlined-ed5d721f.js";import{A as J}from"./ApiOutlined-794f7cc9.js";var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 418.7C765.6 297.9 648.9 212 512.2 212S258.8 297.8 213 418.6C127.3 441.1 64 519.1 64 612c0 110.5 89.5 200 199.9 200h496.2C870.5 812 960 722.5 960 612c0-92.7-63.1-170.7-148.6-193.3zm36.3 281a123.07 123.07 0 01-87.6 36.3H263.9c-33.1 0-64.2-12.9-87.6-36.3A123.3 123.3 0 01140 612c0-28 9.1-54.3 26.2-76.3a125.7 125.7 0 0166.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10c54.3 14.5 92.1 63.8 92.1 120 0 33.1-12.9 64.3-36.3 87.7z"}}]},name:"cloud",theme:"outlined"};const ge=ve;function Q(l){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),i.forEach(function(r){ye(l,r,n[r])})}return l}function ye(l,e,n){return e in l?Object.defineProperty(l,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[e]=n,l}var E=function(e,n){var i=Q({},e,n.attrs);return a(H,Q({},i,{icon:ge}),null)};E.displayName="CloudOutlined";E.inheritAttrs=!1;const he=E;var be={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-600 72h560v208H232V136zm560 480H232V408h560v208zm0 272H232V680h560v208zM304 240a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0zm0 272a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"database",theme:"outlined"};const ke=be;function W(l){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),i.forEach(function(r){Oe(l,r,n[r])})}return l}function Oe(l,e,n){return e in l?Object.defineProperty(l,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[e]=n,l}var N=function(e,n){var i=W({},e,n.attrs);return a(H,W({},i,{icon:ke}),null)};N.displayName="DatabaseOutlined";N.inheritAttrs=!1;const Ce=N;var we={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};const $e=we;function X(l){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},i=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),i.forEach(function(r){Se(l,r,n[r])})}return l}function Se(l,e,n){return e in l?Object.defineProperty(l,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):l[e]=n,l}var F=function(e,n){var i=X({},e,n.attrs);return a(H,X({},i,{icon:$e}),null)};F.displayName="ImportOutlined";F.inheritAttrs=!1;const Pe=F;const ze={key:0,class:"empty-state"},Te={__name:"ImportToolDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","imported"],setup(l,{emit:e}){const n=l,i=_=>{_||(y.value=[])},r=[{title:"工具名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"description",key:"description"},{title:"配置",key:"hasConfig"}],h=v([]),b=v(!1),O=v(!1),y=v([]),j=async()=>{b.value=!0;try{await x({method:"get",url:"/api/v1/tool-builtin",onSuccess:_=>{h.value=(_==null?void 0:_.tools)||[]}})}catch(_){console.error("Failed to load builtin tools:",_)}finally{b.value=!1}},k=_=>{y.value=_},A=async()=>{if(y.value.length===0){le.warning("请选择要导入的工具");return}O.value=!0;try{await x({method:"post",url:"/api/v1/tool-builtin/import",data:{tool_id:y.value[0]},successMessage:"工具导入成功",onSuccess:()=>{e("imported"),I()}})}catch(_){console.error("Failed to import tool:",_)}finally{O.value=!1}},I=()=>{y.value=[],e("update:visible",!1)};return Y(()=>{i(n.visible),j()}),(_,L)=>{const D=m("a-empty"),$=m("a-tag"),M=m("a-table"),B=m("a-spin"),d=m("a-modal");return u(),g(d,{open:l.visible,title:"导入内置工具","confirm-loading":O.value,width:700,"ok-text":"确定","cancel-text":"取消",onOk:A,onCancel:I},{default:t(()=>[a(B,{spinning:b.value},{default:t(()=>[h.value.length===0&&!b.value?(u(),w("div",ze,[a(D,{description:"没有可用的内置工具"})])):(u(),g(M,{key:1,columns:r,"data-source":h.value,pagination:!1,"row-selection":{selectedRowKeys:y.value,onChange:k,type:"radio"},"row-key":o=>o.id},{bodyCell:t(({column:o,record:S})=>[o.key==="hasConfig"?(u(),w(Z,{key:0},[S.has_config?(u(),g($,{key:0,color:"blue"},{default:t(()=>[p("有配置")]),_:1})):(u(),g($,{key:1,color:"green"},{default:t(()=>[p("无配置")]),_:1}))],64)):K("",!0)]),_:1},8,["data-source","row-selection","row-key"]))]),_:1},8,["spinning"])]),_:1},8,["open","confirm-loading"])}}},xe=oe(Te,[["__scopeId","data-v-2bc8fd8b"]]),Ie={class:"action-bar"},De=["onClick"],je={key:1},Ae={key:1},Me={key:5},Fe={__name:"ToolListView",setup(l){const e=ie(),n=v(!1),i=v([]),r=v(0),h=v(1),b=v(10),O=v(""),y=v(!1),j=[{title:"名称",dataIndex:"name",key:"name",width:160,ellipsis:!0,tooltip:!0},{title:"描述",dataIndex:"description",key:"description",width:200,ellipsis:!0,tooltip:!0},{title:"类型",key:"type",width:100},{title:"状态",key:"status",width:100},{title:"版本",key:"version",width:100,ellipsis:!0,tooltip:!0},{title:"创建时间",key:"created_at",width:160,ellipsis:!0,tooltip:!0},{title:"操作",key:"action",width:280,fixed:"right"}];Y(()=>{k()});const k=async()=>{n.value=!0;try{await x({method:"get",url:"/api/v1/tool",params:{page:h.value,size:b.value,search:O.value||void 0},onSuccess:(d,o)=>{i.value=d,r.value=o.total},errorMessage:"获取工具列表失败"})}finally{n.value=!1}},A=()=>{h.value=1,k()},I=(d,o)=>{h.value=d,b.value=o,k()},_=(d,o)=>{h.value=1,b.value=o,k()},L=async d=>{try{await x({method:"delete",url:`/api/v1/tool/${d}`,successMessage:"删除成功",errorMessage:"删除失败"}),k()}catch(o){console.error("Error deleting tool:",o)}},D=async(d,o)=>{try{await x({method:"patch",url:`/api/v1/tool/${d}/${o?"enable":"disable"}`,successMessage:`${o?"启用":"禁用"}成功`,errorMessage:`${o?"启用":"禁用"}失败`}),k()}catch(S){console.error(`Error ${o?"enabling":"disabling"} tool:`,S)}},$=d=>{e.push(`/tool/create?type=${d}`)},M=d=>{switch(d){case"http":return"blue";case"database":return"purple";default:return"green"}},B=d=>{switch(d){case"http":return"HTTP工具";case"database":return"数据库工具";default:return"基础工具"}};return(d,o)=>{const S=m("a-input-search"),C=m("a-button"),z=m("a-menu-item"),R=m("a-menu"),U=m("a-dropdown"),V=m("a-tag"),ee=m("a-popconfirm"),te=m("a-space"),ae=m("a-table"),ne=m("a-card");return u(),g(ue,{"current-page-key":"tool"},{default:t(()=>[a(ne,{title:"工具管理"},{default:t(()=>[q("div",Ie,[a(S,{value:O.value,"onUpdate:value":o[0]||(o[0]=s=>O.value=s),placeholder:"搜索工具名称或描述",style:{width:"300px"},onSearch:A},null,8,["value"]),q("div",null,[a(U,null,{overlay:t(()=>[a(R,null,{default:t(()=>[a(z,{key:"basic",onClick:o[1]||(o[1]=s=>$("basic"))},{icon:t(()=>[a(c(de))]),default:t(()=>[p(" 基础工具 ")]),_:1}),a(z,{key:"http",onClick:o[2]||(o[2]=s=>$("http"))},{icon:t(()=>[a(c(J))]),default:t(()=>[p(" HTTP工具 ")]),_:1}),a(z,{key:"database",onClick:o[3]||(o[3]=s=>$("database"))},{icon:t(()=>[a(c(Ce))]),default:t(()=>[p(" 数据库工具 ")]),_:1})]),_:1})]),default:t(()=>[a(C,{type:"primary",style:{"margin-right":"8px"}},{icon:t(()=>[a(c(se))]),default:t(()=>[p(" 创建工具 "),a(c(G))]),_:1})]),_:1}),a(U,null,{overlay:t(()=>[a(R,null,{default:t(()=>[a(z,{key:"1",onClick:o[4]||(o[4]=s=>y.value=!0)},{default:t(()=>[a(c(J)),p(" 导入内置工具 ")]),_:1}),a(z,{key:"2",onClick:o[5]||(o[5]=s=>c(e).push("/tool/import-openapi"))},{default:t(()=>[a(c(he)),p(" 导入OpenAPI ")]),_:1})]),_:1})]),default:t(()=>[a(C,null,{icon:t(()=>[a(c(Pe))]),default:t(()=>[p(" 导入工具 "),a(c(G))]),_:1})]),_:1})])]),a(ae,{columns:j,"data-source":i.value,loading:n.value,pagination:{current:h.value,pageSize:b.value,total:r.value,onChange:I,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],onShowSizeChange:_,showTotal:s=>`共 ${s} 条记录`},"row-key":s=>s.id},{bodyCell:t(({column:s,record:f})=>[s.key==="name"?(u(),w("a",{key:0,onClick:T=>c(e).push(`/tool/${f.id}`)},P(f.name),9,De)):s.key==="description"?(u(),w("span",je,P(f.description||"无描述"),1)):s.key==="type"?(u(),g(V,{key:2,color:M(f.type)},{default:t(()=>[p(P(B(f.type)),1)]),_:2},1032,["color"])):s.key==="status"?(u(),g(V,{key:3,color:f.is_enabled?"green":"red"},{default:t(()=>[p(P(f.is_enabled?"已启用":"已禁用"),1)]),_:2},1032,["color"])):s.key==="version"?(u(),w(Z,{key:4},[f.current_version?(u(),g(V,{key:0,color:"blue"},{default:t(()=>[p("v"+P(f.current_version),1)]),_:2},1024)):(u(),w("span",Ae,"未发布"))],64)):s.key==="created_at"?(u(),w("span",Me,P(c(pe)(f.created_at)),1)):s.key==="action"?(u(),g(te,{key:6,size:0},{default:t(()=>[a(C,{type:"link",size:"small",onClick:T=>c(e).push(`/tool/${f.id}/debug`)},{icon:t(()=>[a(c(fe))]),default:t(()=>[p(" 调试 ")]),_:2},1032,["onClick"]),a(C,{type:"link",size:"small",onClick:T=>c(e).push(`/tool/${f.id}/edit`)},{icon:t(()=>[a(c(re))]),default:t(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),f.is_enabled?(u(),g(C,{key:0,type:"link",size:"small",onClick:T=>D(f.id,!1)},{icon:t(()=>[a(c(me))]),default:t(()=>[p(" 禁用 ")]),_:2},1032,["onClick"])):(u(),g(C,{key:1,type:"link",size:"small",onClick:T=>D(f.id,!0)},{icon:t(()=>[a(c(_e))]),default:t(()=>[p(" 启用 ")]),_:2},1032,["onClick"])),a(ee,{title:"确定要删除此工具吗？","ok-text":"确定","cancel-text":"取消",onConfirm:T=>L(f.id)},{default:t(()=>[a(C,{type:"link",size:"small",danger:""},{icon:t(()=>[a(c(ce))]),default:t(()=>[p(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):K("",!0)]),_:1},8,["data-source","loading","pagination","row-key"])]),_:1}),a(xe,{visible:y.value,"onUpdate:visible":o[6]||(o[6]=s=>y.value=s),onImported:k},null,8,["visible"])]),_:1})}}};export{Fe as default};
