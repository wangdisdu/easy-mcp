import{r as f,o as w,x as _,y as z,v as r,c as p,j as v,e as k,f as B,S as b,k as x,h as E,z as L,B as M,C as g}from"./index-53057e88.js";/* empty css                                                     */const P={class:"monaco-editor-wrapper"},S={key:0,class:"monaco-editor-loading"},D={__name:"MonacoEditor",props:{value:{type:String,default:""},language:{type:String,default:"javascript"},options:{type:Object,default:()=>({})},height:{type:String,default:"400px"},readOnly:{type:Boolean,default:!1}},emits:["update:value","editor-mounted"],setup(l,{expose:y,emit:u}){const o=l,s=f(null),d=f(!0);let e=null,a=null,i=null;const m=async()=>{!s.value||e||(M(),e=g.create(s.value,{value:o.value,language:o.language,theme:"vs",automaticLayout:!1,scrollBeyondLastLine:!1,minimap:{enabled:!1},readOnly:o.readOnly,...o.options}),i=e.onDidChangeModelContent(()=>{const t=e.getValue();u("update:value",t)}),window.ResizeObserver?(a=new ResizeObserver(()=>{e&&e.layout()}),a.observe(s.value)):window.addEventListener("resize",c),u("editor-mounted",e),d.value=!1)},c=()=>{e&&e.layout()},h=async()=>{if(!e)return!1;try{return await e.getAction("editor.action.formatDocument").run(),!0}catch(t){return console.error("格式化代码时出错:",t),!1}},C=(t,n=1)=>{e&&(e.setPosition({lineNumber:t,column:n}),e.revealPositionInCenter({lineNumber:t,column:n}),e.focus())},O=()=>e;return w(async()=>{await _(),m()}),z(()=>{window.removeEventListener("resize",c),a&&(a.disconnect(),a=null),i&&(i.dispose(),i=null),e&&(e.dispose(),e=null)}),r(()=>o.value,t=>{if(e&&t!==e.getValue()){const n=e.getPosition();e.setValue(t),n&&(e.setPosition(n),e.revealPositionInCenter(n))}}),r(()=>o.language,t=>{e&&g.setModelLanguage(e.getModel(),t)}),r(()=>o.options,t=>{e&&e.updateOptions(t)},{deep:!0}),r(()=>o.readOnly,t=>{e&&e.updateOptions({readOnly:t})}),y({formatCode:h,setCursorPosition:C,getEditor:O}),(t,n)=>(p(),v("div",P,[d.value?(p(),v("div",S,[k(B(b),{tip:"加载编辑器中..."})])):x("",!0),E("div",{ref_key:"editorContainer",ref:s,class:"monaco-editor-container",style:L({height:l.height})},null,4)]))}};export{D as _};
