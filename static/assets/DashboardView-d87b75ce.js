import{_ as $,u as D,r as b,a as O,o as B,b as u,c as E,d as M,w as t,e,f as i,g as l,h as n,t as c,U as N,p as R,i as F}from"./index-53057e88.js";import{c as p,A as U,T as L,F as j,S as q,f as G}from"./AppLayout-7b7aaf0d.js";const h=v=>(R("data-v-186ba192"),v=v(),F(),v),H={class:"stat-card"},J={class:"stat-number"},K=h(()=>n("div",{class:"stat-label"},"已注册工具",-1)),P={class:"stat-card"},Q={class:"stat-number"},W=h(()=>n("div",{class:"stat-label"},"已注册函数",-1)),X={class:"stat-card"},Y={class:"stat-number"},Z=h(()=>n("div",{class:"stat-label"},"已创建配置",-1)),tt={class:"stat-card"},et={class:"stat-number"},at=h(()=>n("div",{class:"stat-label"},"系统用户",-1)),ot=["onClick"],st={__name:"DashboardView",setup(v){const f=D(),m=b(!1),r=O({toolCount:0,funcCount:0,configCount:0,userCount:0}),y=b([]),C=b([]);B(async()=>{m.value=!0;try{await T(),await z(),await A()}finally{m.value=!1}});const T=async()=>{try{await p({method:"get",url:"/api/v1/tool",params:{page:1,size:1},onSuccess:(a,o)=>{r.toolCount=o.total||0}}),await p({method:"get",url:"/api/v1/func",params:{page:1,size:1},onSuccess:(a,o)=>{r.funcCount=o.total||0}}),await p({method:"get",url:"/api/v1/config",params:{page:1,size:1},onSuccess:(a,o)=>{r.configCount=o.total||0}}),await p({method:"get",url:"/api/v1/user",params:{page:1,size:1},onSuccess:(a,o)=>{r.userCount=o.total||0}})}catch(a){console.error("Error fetching stats:",a)}},z=async()=>{try{await p({method:"get",url:"/api/v1/audit",params:{page:1,size:5},onSuccess:a=>{y.value=a}})}catch(a){console.error("Error fetching recent activities:",a)}},A=async()=>{try{await p({method:"get",url:"/api/v1/tool",params:{page:1,size:5},onSuccess:a=>{C.value=a}})}catch(a){console.error("Error fetching recent tools:",a)}},I=a=>({create:"创建",update:"更新",delete:"删除",deploy:"发布",rollback:"回滚"})[a]||a;return(a,o)=>{const g=u("a-button"),d=u("a-card"),_=u("a-col"),w=u("a-row"),k=u("a-list-item-meta"),S=u("a-list-item"),x=u("a-list"),V=u("a-tag");return E(),M(U,{"current-page-key":"dashboard"},{default:t(()=>[e(d,{title:"仪表盘"},{default:t(()=>[e(w,{gutter:16},{default:t(()=>[e(_,{span:6},{default:t(()=>[e(d,null,{title:t(()=>[e(i(L)),l(" 工具 ")]),default:t(()=>[n("div",H,[n("div",J,c(r.toolCount),1),K]),e(g,{type:"link",onClick:o[0]||(o[0]=s=>i(f).push("/tool"))},{default:t(()=>[l("查看全部")]),_:1})]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(d,null,{title:t(()=>[e(i(j)),l(" 函数 ")]),default:t(()=>[n("div",P,[n("div",Q,c(r.funcCount),1),W]),e(g,{type:"link",onClick:o[1]||(o[1]=s=>i(f).push("/func"))},{default:t(()=>[l("查看全部")]),_:1})]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(d,null,{title:t(()=>[e(i(q)),l(" 配置 ")]),default:t(()=>[n("div",X,[n("div",Y,c(r.configCount),1),Z]),e(g,{type:"link",onClick:o[2]||(o[2]=s=>i(f).push("/config"))},{default:t(()=>[l("查看全部")]),_:1})]),_:1})]),_:1}),e(_,{span:6},{default:t(()=>[e(d,null,{title:t(()=>[e(i(N)),l(" 用户 ")]),default:t(()=>[n("div",tt,[n("div",et,c(r.userCount),1),at]),e(g,{type:"link",onClick:o[3]||(o[3]=s=>i(f).push("/user"))},{default:t(()=>[l("查看全部")]),_:1})]),_:1})]),_:1})]),_:1}),e(w,{gutter:16,style:{"margin-top":"16px"}},{default:t(()=>[e(_,{span:12},{default:t(()=>[e(d,{title:"最近活动"},{default:t(()=>[e(x,{"data-source":y.value,loading:m.value},{renderItem:t(({item:s})=>[e(S,null,{default:t(()=>[e(k,null,{title:t(()=>[l(c(I(s.action))+" "+c(s.resource_type),1)]),description:t(()=>[l(c(s.username)+" - "+c(i(G)(s.created_at)),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1})]),_:1}),e(_,{span:12},{default:t(()=>[e(d,{title:"最近工具"},{default:t(()=>[e(x,{"data-source":C.value,loading:m.value},{renderItem:t(({item:s})=>[e(S,null,{actions:t(()=>[e(V,{color:s.is_enabled?"green":"red"},{default:t(()=>[l(c(s.is_enabled?"已启用":"已禁用"),1)]),_:2},1032,["color"])]),default:t(()=>[e(k,null,{title:t(()=>[n("a",{onClick:nt=>i(f).push(`/tool/${s.id}`)},c(s.name),9,ot)]),description:t(()=>[l(c(s.description||"无描述"),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["data-source","loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},it=$(st,[["__scopeId","data-v-186ba192"]]);export{it as default};
