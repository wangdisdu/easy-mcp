import{e as o,A as q,_ as G,r as m,o as N,b as p,c as n,d as y,w as e,j as O,F,g as _,k as L,m as J,u as K,h as A,f as d,P as Q,t as I,E as W,l as X,D as Y}from"./index-53057e88.js";import{c as z,A as Z,f as ee}from"./AppLayout-7b7aaf0d.js";import{P as te}from"./PauseCircleOutlined-d1e3a9d8.js";import{P as oe}from"./PlayCircleOutlined-63c522dd.js";var ae={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};const ne=ae;function j(c){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?Object(arguments[a]):{},v=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(s).filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable}))),v.forEach(function(g){le(c,g,s[g])})}return c}function le(c,a,s){return a in c?Object.defineProperty(c,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):c[a]=s,c}var E=function(a,s){var v=j({},a,s.attrs);return o(q,j({},v,{icon:ne}),null)};E.displayName="ImportOutlined";E.inheritAttrs=!1;const se=E;const ie={key:0,class:"empty-state"},re={__name:"ImportToolDialog",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","imported"],setup(c,{emit:a}){const s=c,v=i=>{i||(f.value=[])},g=[{title:"工具名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"description",key:"description"},{title:"配置",key:"hasConfig"}],h=m([]),k=m(!1),w=m(!1),f=m([]),D=async()=>{k.value=!0;try{await z({method:"get",url:"/api/v1/tool-builtin",onSuccess:i=>{h.value=(i==null?void 0:i.tools)||[]}})}catch(i){console.error("Failed to load builtin tools:",i)}finally{k.value=!1}},b=i=>{f.value=i},M=async()=>{if(f.value.length===0){J.warning("请选择要导入的工具");return}w.value=!0;try{await z({method:"post",url:"/api/v1/tool-builtin/import",data:{tool_id:f.value[0]},successMessage:"工具导入成功",onSuccess:()=>{a("imported"),P()}})}catch(i){console.error("Failed to import tool:",i)}finally{w.value=!1}},P=()=>{f.value=[],a("update:visible",!1)};return N(()=>{v(s.visible),D()}),(i,V)=>{const T=p("a-empty"),u=p("a-tag"),t=p("a-table"),$=p("a-spin"),C=p("a-modal");return n(),y(C,{open:c.visible,title:"导入内置工具","confirm-loading":w.value,width:700,"ok-text":"确定","cancel-text":"取消",onOk:M,onCancel:P},{default:e(()=>[o($,{spinning:k.value},{default:e(()=>[h.value.length===0&&!k.value?(n(),O("div",ie,[o(T,{description:"没有可用的内置工具"})])):(n(),y(t,{key:1,columns:g,"data-source":h.value,pagination:!1,"row-selection":{selectedRowKeys:f.value,onChange:b,type:"radio"},"row-key":x=>x.id},{bodyCell:e(({column:x,record:B})=>[x.key==="hasConfig"?(n(),O(F,{key:0},[B.has_config?(n(),y(u,{key:0,color:"blue"},{default:e(()=>[_("有配置")]),_:1})):(n(),y(u,{key:1,color:"green"},{default:e(()=>[_("无配置")]),_:1}))],64)):L("",!0)]),_:1},8,["data-source","row-selection","row-key"]))]),_:1},8,["spinning"])]),_:1},8,["open","confirm-loading"])}}},ce=G(re,[["__scopeId","data-v-39d45ada"]]),ue={class:"action-bar"},de=["onClick"],pe={key:1},_e={key:1},me={key:4},he={__name:"ToolListView",setup(c){const a=K(),s=m(!1),v=m([]),g=m(0),h=m(1),k=m(10),w=m(""),f=m(!1),D=[{title:"名称",dataIndex:"name",key:"name",width:160,ellipsis:!0,tooltip:!0},{title:"描述",dataIndex:"description",key:"description",width:200,ellipsis:!0,tooltip:!0},{title:"状态",key:"status",width:100,ellipsis:!0,tooltip:!0},{title:"版本",key:"version",width:100,ellipsis:!0,tooltip:!0},{title:"创建时间",key:"created_at",width:160,ellipsis:!0,tooltip:!0},{title:"操作",key:"action",width:280,fixed:"right"}];N(()=>{b()});const b=async()=>{s.value=!0;try{await z({method:"get",url:"/api/v1/tool",params:{page:h.value,size:k.value,search:w.value||void 0},onSuccess:(u,t)=>{v.value=u,g.value=t.total},errorMessage:"获取工具列表失败"})}finally{s.value=!1}},M=()=>{h.value=1,b()},P=(u,t)=>{h.value=u,k.value=t,b()},i=(u,t)=>{h.value=1,k.value=t,b()},V=async u=>{try{await z({method:"delete",url:`/api/v1/tool/${u}`,successMessage:"删除成功",errorMessage:"删除失败"}),b()}catch(t){console.error("Error deleting tool:",t)}},T=async(u,t)=>{try{await z({method:"patch",url:`/api/v1/tool/${u}/${t?"enable":"disable"}`,successMessage:`${t?"启用":"禁用"}成功`,errorMessage:`${t?"启用":"禁用"}失败`}),b()}catch($){console.error(`Error ${t?"enabling":"disabling"} tool:`,$)}};return(u,t)=>{const $=p("a-input-search"),C=p("a-button"),x=p("a-tag"),B=p("a-popconfirm"),R=p("a-space"),H=p("a-table"),U=p("a-card");return n(),y(Z,{"current-page-key":"tool"},{default:e(()=>[o(U,{title:"工具管理"},{default:e(()=>[A("div",ue,[o($,{value:w.value,"onUpdate:value":t[0]||(t[0]=l=>w.value=l),placeholder:"搜索工具名称或描述",style:{width:"300px"},onSearch:M},null,8,["value"]),A("div",null,[o(C,{type:"primary",style:{"margin-right":"8px"},onClick:t[1]||(t[1]=l=>d(a).push("/tool/create"))},{icon:e(()=>[o(d(Q))]),default:e(()=>[_(" 创建工具 ")]),_:1}),o(C,{onClick:t[2]||(t[2]=l=>f.value=!0)},{icon:e(()=>[o(d(se))]),default:e(()=>[_(" 导入工具 ")]),_:1})])]),o(H,{columns:D,"data-source":v.value,loading:s.value,pagination:{current:h.value,pageSize:k.value,total:g.value,onChange:P,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],onShowSizeChange:i,showTotal:l=>`共 ${l} 条记录`},"row-key":l=>l.id},{bodyCell:e(({column:l,record:r})=>[l.key==="name"?(n(),O("a",{key:0,onClick:S=>d(a).push(`/tool/${r.id}`)},I(r.name),9,de)):l.key==="description"?(n(),O("span",pe,I(r.description||"无描述"),1)):l.key==="status"?(n(),y(x,{key:2,color:r.is_enabled?"green":"red"},{default:e(()=>[_(I(r.is_enabled?"已启用":"已禁用"),1)]),_:2},1032,["color"])):l.key==="version"?(n(),O(F,{key:3},[r.current_version?(n(),y(x,{key:0,color:"blue"},{default:e(()=>[_("v"+I(r.current_version),1)]),_:2},1024)):(n(),O("span",_e,"未发布"))],64)):l.key==="created_at"?(n(),O("span",me,I(d(ee)(r.created_at)),1)):l.key==="action"?(n(),y(R,{key:5},{default:e(()=>[o(C,{type:"link",size:"small",onClick:S=>d(a).push(`/tool/${r.id}`)},{icon:e(()=>[o(d(W))]),default:e(()=>[_(" 查看 ")]),_:2},1032,["onClick"]),o(C,{type:"link",size:"small",onClick:S=>d(a).push(`/tool/${r.id}/edit`)},{icon:e(()=>[o(d(X))]),default:e(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),r.is_enabled?(n(),y(C,{key:0,type:"link",size:"small",onClick:S=>T(r.id,!1)},{icon:e(()=>[o(d(te))]),default:e(()=>[_(" 禁用 ")]),_:2},1032,["onClick"])):(n(),y(C,{key:1,type:"link",size:"small",onClick:S=>T(r.id,!0)},{icon:e(()=>[o(d(oe))]),default:e(()=>[_(" 启用 ")]),_:2},1032,["onClick"])),o(B,{title:"确定要删除此工具吗？","ok-text":"确定","cancel-text":"取消",onConfirm:S=>V(r.id)},{default:e(()=>[o(C,{type:"link",size:"small",danger:""},{icon:e(()=>[o(d(Y))]),default:e(()=>[_(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):L("",!0)]),_:1},8,["data-source","loading","pagination","row-key"])]),_:1}),o(ce,{visible:f.value,"onUpdate:visible":t[3]||(t[3]=l=>f.value=l),onImported:b},null,8,["visible"])]),_:1})}}};export{he as default};
